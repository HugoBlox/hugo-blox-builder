{{ $ := .root }}
{{ $page := .page }}
{{ $work_len := len (where $.Site.RegularPages "Type" "work") }}

<!-- Works widget -->
<div class="container-work">
    <div class="row">
        <div class="col-xs-12 col-md-4 section-heading">
            <h1>{{ with $page.Title }}{{ . | markdownify }}{{ end }}</h1>
      {{ with $page.Params.subtitle }}<p>{{ . | markdownify }}</p>{{ end }}
        </div>
        <div class="col-xs-12 col-md-8">
          {{ with $page.Content }}<p>{{ . | markdownify }}</p>{{ end }}
          {{ range first $page.Params.count (sort (where $.Site.RegularPages "Type" "work") ".Params.time_start" "desc") }}
            <div class="work-metadata" style="margin-bottom: 1rem">
              <div class="row">
                  <div class="col-xs-12 col-sm-6">
                    <span itemprop="name"><a href="{{ .Permalink }}">{{ .Title }}</a></span>
                  </div>
                  <div class="col-xs-12 col-sm-6 work-date">
                    {{ $date := .Params.time_start | default .Date }}
                    {{ (time $date).Format $.Site.Params.work.date_format_main }}
                    &mdash;
                    {{ $date := .Params.time_end | default .Date }} 
                    {{ (time $date).Format $.Site.Params.work.date_format_main }}
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    {{ .Params.employer | markdownify }}
                  </div>
                  <div class="col-xs-12 col-sm-6 work-location">
                    {{ .Params.location }}
                  </div>
              </div>
            </div>
          {{ end }}  
        </div>
    </div>
</div>