{{ $scr := newScratch }}

{{ $pack := or .icon_pack "fas" }}
{{ $scr.SetInMap "social_link" "icon_pack" $pack }}

{{ $pack_prefix := $pack }}
{{ if in (slice "fab" "fas" "far" "fal") $pack }}
  {{ $pack_prefix = "fa" }}
{{ end }}
{{ $scr.SetInMap "social_link" "pack_prefix" $pack_prefix }}

{{ $link := .link }}
{{ $target := "" }}
{{ $scheme := (urls.Parse $link).Scheme }}
{{ if not $scheme }}
  {{ $link = .link | relLangURL }}
{{ else if in (slice "http" "https") $scheme }}
  {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
{{ end }}
{{ $scr.SetInMap "social_link" "link" $link }}
{{ $scr.SetInMap "social_link" "target" $target }}

{{ return $scr.Get "social_link" }}
